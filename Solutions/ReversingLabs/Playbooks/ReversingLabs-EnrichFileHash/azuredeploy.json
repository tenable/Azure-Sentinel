{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "ReversingLabs-EnrichFileHash",
        "description": "This playbook will enrich a Sentinel Incident with file hash information from ReversingLabs TitaniumCloud. A comment will be added to the incident with details about the file.",
        "prerequisites": [
            "ReversingLabs TitaniumCloud license",
            "ReversingLabs TitaniumCloud username and password"
        ],
        "lastUpdateTime": "2022-08-08T10:00:00.000Z",
        "entities": ["FileHash"],
        "tags": ["Enrichment"],
        "author": {
            "name": "Aaron Hoffmann"
        }
    },
    "parameters": {
        "PlaybookName": {
            "defaultValue": "ReversingLabs-EnrichFileHash",
            "type": "string",
            "metadata": {
                "description": "Name of the playbook (Logic Apps resources) which will be created"
            }
        }
    },
    "variables": {
        "AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('PlaybookName'))]",
        "ReversingLabsConnectionName": "[concat('reversinglabs-', parameters('PlaybookName'))]"
    },
    "resources": [
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('AzureSentinelConnectionName')]",
            "location": "[resourceGroup().location]",
            "properties": {
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                }
            }
        },
        {
            "type": "Microsoft.Web/connections",
            "apiVersion": "2016-06-01",
            "name": "[variables('ReversingLabsConnectionName')]",
            "location": "[resourceGroup().location]",
            "properties": {
                "displayName": "[variables('ReversingLabsConnectionName')]",
                "customParameterValues": {},
                "api": {
                    "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                }
            }
        },
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('PlaybookName')]",
            "location": "[resourceGroup().location]",
            "dependson": [
                "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('ReversingLabsConnectionName'))]"
            ],
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        }
                    },
                    "triggers": {
                        "Microsoft_Sentinel_incident": {
                            "type": "ApiConnectionWebhook",
                            "inputs": {
                                "body": {
                                    "callback_url": "@{listCallbackUrl()}"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "path": "/incident-creation"
                            }
                        }
                    },
                    "actions": {
                        "Entities_-_Get_FileHashes": {
                            "runAfter": {},
                            "type": "ApiConnection",
                            "inputs": {
                                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/entities/filehash"
                            }
                        },
                        "For_each_-_File_hash_reputation": {
                            "foreach": "@body('Entities_-_Get_FileHashes')?['Filehashes']",
                            "actions": {
                                "Add_comment_to_incident_(V3)": {
                                    "runAfter": {
                                        "Set_comment_logo": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "body": {
                                            "incidentArmId": "@triggerBody()?['object']?['id']",
                                            "message": "<p><span style=\"font-size: 16px\"><strong></strong></span><span style=\"font-size: 16px\"><strong>@{outputs('Set_comment_logo')}</strong></span><span style=\"font-size: 16px\"><strong>ReversingLabs - Enrich File Hash</strong></span><span style=\"font-size: 16px\"><strong>@{variables('results_comment')}</strong></span><span style=\"font-size: 16px\"><strong></strong></span></p>"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/Incidents/Comment"
                                    }
                                },
                                "Clear_analysis_story_variable": {
                                    "runAfter": {
                                        "Parse_hash_reputation_JSON": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "analysis_story",
                                        "value": " "
                                    }
                                },
                                "Clear_results_body_variable": {
                                    "runAfter": {
                                        "Clear_analysis_story_variable": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "results_body",
                                        "value": " "
                                    }
                                },
                                "Close_results_table": {
                                    "runAfter": {
                                        "Condition_If_Hash_Unknown": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "AppendToStringVariable",
                                    "inputs": {
                                        "name": "results_comment",
                                        "value": "@{variables('results_body')}</table>"
                                    }
                                },
                                "Condition_If_Hash_Unknown": {
                                    "actions": {
                                        "Append_to_string_variable_unknown": {
                                            "runAfter": {
                                                "Compose_unknown_reputation": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToStringVariable",
                                            "inputs": {
                                                "name": "results_body",
                                                "value": "@outputs('Compose_unknown_reputation')"
                                            }
                                        },
                                        "Compose_unknown_reputation": {
                                            "runAfter": {},
                                            "type": "Compose",
                                            "inputs": "<tr>\n  <td style=\"font-weight: bold;\">Hash (@{items('For_each_-_File_hash_reputation')?['Algorithm']})</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['query_hash']?['sha256']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status</td>\n  <td style=\"background-color: grey; font-weight: bold; color: white\">@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status Description</td>\n  <td>The sample has not received a classification. It does not exist in the file reputation database, or there is no information on whether it is malicious or not.</td>\n</tr>"
                                        }
                                    },
                                    "runAfter": {
                                        "Set_variable": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "For_each_Analysis_story": {
                                                "foreach": "@body('Parse_JSON_file_hash_analysis')?['rl']?['sample']?['analysis']?['entries']",
                                                "actions": {
                                                    "Append_to_string_variable": {
                                                        "runAfter": {},
                                                        "type": "AppendToStringVariable",
                                                        "inputs": {
                                                            "name": "analysis_story",
                                                            "value": "@items('For_each_Analysis_story')?['tc_report']?['story']"
                                                        }
                                                    }
                                                },
                                                "runAfter": {
                                                    "Parse_JSON_file_hash_analysis": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "type": "Foreach"
                                            },
                                            "Get_File_Hash_Analysis_Detail": {
                                                "runAfter": {},
                                                "type": "ApiConnection",
                                                "inputs": {
                                                    "headers": {
                                                        "User-Agent": "ReversingLabs Azure Connector TiCloud v1.0.0"
                                                    },
                                                    "host": {
                                                        "connection": {
                                                            "name": "@parameters('$connections')['reversinglabsintelligence']['connectionId']"
                                                        }
                                                    },
                                                    "method": "get",
                                                    "path": "/api/databrowser/rldata/query/@{encodeURIComponent(toLower(string(items('For_each_-_File_hash_reputation')?['Algorithm'])))}/@{encodeURIComponent(items('For_each_-_File_hash_reputation')?['Value'])}",
                                                    "queries": {
                                                        "format": "json"
                                                    }
                                                }
                                            },
                                            "Parse_JSON_file_hash_analysis": {
                                                "runAfter": {
                                                    "Switch_-_reason": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "type": "ParseJson",
                                                "inputs": {
                                                    "content": "@body('Get_File_Hash_Analysis_Detail')",
                                                    "schema": {
                                                        "properties": {
                                                            "rl": {
                                                                "properties": {
                                                                    "sample": {
                                                                        "properties": {
                                                                            "analysis": {
                                                                                "properties": {
                                                                                    "entries": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "analysis_type": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "analysis_version": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "record_time": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "tc_report": {
                                                                                                    "properties": {
                                                                                                        "info": {
                                                                                                            "properties": {
                                                                                                                "file": {
                                                                                                                    "properties": {
                                                                                                                        "file_subtype": {
                                                                                                                            "type": "string"
                                                                                                                        },
                                                                                                                        "file_type": {
                                                                                                                            "type": "string"
                                                                                                                        }
                                                                                                                    },
                                                                                                                    "type": "object"
                                                                                                                },
                                                                                                                "identification": {
                                                                                                                    "properties": {
                                                                                                                        "name": {
                                                                                                                            "type": "string"
                                                                                                                        }
                                                                                                                    },
                                                                                                                    "type": "object"
                                                                                                                },
                                                                                                                "validation": {
                                                                                                                    "properties": {
                                                                                                                        "valid": {
                                                                                                                            "type": "boolean"
                                                                                                                        }
                                                                                                                    },
                                                                                                                    "type": "object"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "interesting_strings": {
                                                                                                            "items": {
                                                                                                                "properties": {
                                                                                                                    "category": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "values": {
                                                                                                                        "items": {
                                                                                                                            "type": "string"
                                                                                                                        },
                                                                                                                        "type": "array"
                                                                                                                    }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                    "category",
                                                                                                                    "values"
                                                                                                                ],
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "type": "array"
                                                                                                        },
                                                                                                        "metadata": {
                                                                                                            "properties": {
                                                                                                                "application": {
                                                                                                                    "properties": {
                                                                                                                        "pe": {
                                                                                                                            "properties": {
                                                                                                                                "dos_header": {
                                                                                                                                    "properties": {
                                                                                                                                        "e_cblp": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_cp": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_cparhdr": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_crlc": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_cs": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_csum": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_ip": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_lfanew": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_lfarlc": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_maxalloc": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_minalloc": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_oemid": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_oeminfo": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_ovno": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_res": {
                                                                                                                                            "type": "string"
                                                                                                                                        },
                                                                                                                                        "e_res2": {
                                                                                                                                            "type": "string"
                                                                                                                                        },
                                                                                                                                        "e_sp": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "e_ss": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "has_rich_header": {
                                                                                                                                            "type": "boolean"
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    "type": "object"
                                                                                                                                },
                                                                                                                                "file_header": {
                                                                                                                                    "properties": {
                                                                                                                                        "characteristics": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "machine": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "number_of_sections": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "number_of_symbols": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "pointer_to_symbol_table": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_optional_headers": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "time_date_stamp": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "time_date_stamp_decoded": {
                                                                                                                                            "type": "string"
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    "type": "object"
                                                                                                                                },
                                                                                                                                "imports": {
                                                                                                                                    "items": {
                                                                                                                                        "properties": {
                                                                                                                                            "apis": {
                                                                                                                                                "items": {
                                                                                                                                                    "type": "string"
                                                                                                                                                },
                                                                                                                                                "type": "array"
                                                                                                                                            },
                                                                                                                                            "name": {
                                                                                                                                                "type": "string"
                                                                                                                                            }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                            "name",
                                                                                                                                            "apis"
                                                                                                                                        ],
                                                                                                                                        "type": "object"
                                                                                                                                    },
                                                                                                                                    "type": "array"
                                                                                                                                },
                                                                                                                                "optional_header": {
                                                                                                                                    "properties": {
                                                                                                                                        "address_of_entry_point": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "base_of_code": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "base_of_data": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "checksum": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "data_directories": {
                                                                                                                                            "items": {
                                                                                                                                                "properties": {
                                                                                                                                                    "address": {
                                                                                                                                                        "type": "integer"
                                                                                                                                                    },
                                                                                                                                                    "size": {
                                                                                                                                                        "type": "integer"
                                                                                                                                                    }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                    "address",
                                                                                                                                                    "size"
                                                                                                                                                ],
                                                                                                                                                "type": "object"
                                                                                                                                            },
                                                                                                                                            "type": "array"
                                                                                                                                        },
                                                                                                                                        "dll_characteristics": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "file_alignment": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "image_base": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "is_checksum_valid": {
                                                                                                                                            "type": "boolean"
                                                                                                                                        },
                                                                                                                                        "loader_flags": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "major_image_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "major_linker_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "major_os_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "major_subsystem_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "minor_image_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "minor_linker_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "minor_os_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "minor_subsystem_version": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "number_of_rva_and_sizes": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "section_alignment": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_code": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_headers": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_heap_commit": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_heap_reserve": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_image": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_initialized_data": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_stack_commit": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_stack_reserve": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "size_of_uninitialized_data": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "subsystem": {
                                                                                                                                            "type": "integer"
                                                                                                                                        },
                                                                                                                                        "win32_version_value": {
                                                                                                                                            "type": "integer"
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    "type": "object"
                                                                                                                                },
                                                                                                                                "resources": {
                                                                                                                                    "items": {
                                                                                                                                        "properties": {
                                                                                                                                            "code_page": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "language_id": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "language_id_name": {
                                                                                                                                                "type": "string"
                                                                                                                                            },
                                                                                                                                            "name": {
                                                                                                                                                "type": "string"
                                                                                                                                            },
                                                                                                                                            "offset": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "size": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "type": {
                                                                                                                                                "type": "string"
                                                                                                                                            }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                            "type",
                                                                                                                                            "name",
                                                                                                                                            "language_id_name",
                                                                                                                                            "language_id",
                                                                                                                                            "code_page",
                                                                                                                                            "offset",
                                                                                                                                            "size"
                                                                                                                                        ],
                                                                                                                                        "type": "object"
                                                                                                                                    },
                                                                                                                                    "type": "array"
                                                                                                                                },
                                                                                                                                "sections": {
                                                                                                                                    "items": {
                                                                                                                                        "properties": {
                                                                                                                                            "address": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "flags": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "name": {
                                                                                                                                                "type": "string"
                                                                                                                                            },
                                                                                                                                            "offset": {
                                                                                                                                                "type": "integer"
                                                                                                                                            },
                                                                                                                                            "size": {
                                                                                                                                                "type": "integer"
                                                                                                                                            }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                            "name",
                                                                                                                                            "flags",
                                                                                                                                            "size",
                                                                                                                                            "address",
                                                                                                                                            "offset"
                                                                                                                                        ],
                                                                                                                                        "type": "object"
                                                                                                                                    },
                                                                                                                                    "type": "array"
                                                                                                                                }
                                                                                                                            },
                                                                                                                            "type": "object"
                                                                                                                        }
                                                                                                                    },
                                                                                                                    "type": "object"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "story": {
                                                                                                            "type": "string"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "record_time",
                                                                                                "analysis_type",
                                                                                                "analysis_version",
                                                                                                "tc_report"
                                                                                            ],
                                                                                            "type": "object"
                                                                                        },
                                                                                        "type": "array"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "crc32": {
                                                                                "type": "string"
                                                                            },
                                                                            "dynamic_analysis": {
                                                                                "properties": {
                                                                                    "entries": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "dynamic_analysis_report": {
                                                                                                    "properties": {
                                                                                                        "analysed_on": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "cuckoo_version": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "network": {
                                                                                                            "properties": {
                                                                                                                "udp_destinations": {
                                                                                                                    "items": {
                                                                                                                        "properties": {
                                                                                                                            "address": {
                                                                                                                                "type": "string"
                                                                                                                            },
                                                                                                                            "port": {
                                                                                                                                "type": "integer"
                                                                                                                            }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                            "port",
                                                                                                                            "address"
                                                                                                                        ],
                                                                                                                        "type": "object"
                                                                                                                    },
                                                                                                                    "type": "array"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        },
                                                                                                        "summary": {
                                                                                                            "properties": {
                                                                                                                "mutexes": {
                                                                                                                    "items": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "type": "array"
                                                                                                                }
                                                                                                            },
                                                                                                            "type": "object"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                },
                                                                                                "dynamic_analysis_report_joe_sandbox": {
                                                                                                    "properties": {
                                                                                                        "analysed_on": {
                                                                                                            "type": "string"
                                                                                                        },
                                                                                                        "joe_sandbox_version": {
                                                                                                            "type": "string"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                }
                                                                                            },
                                                                                            "required": [],
                                                                                            "type": "object"
                                                                                        },
                                                                                        "type": "array"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "imphash": {
                                                                                "type": "string"
                                                                            },
                                                                            "md5": {
                                                                                "type": "string"
                                                                            },
                                                                            "relationships": {
                                                                                "properties": {
                                                                                    "container_sample_sha1": {
                                                                                        "items": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "type": "array"
                                                                                    },
                                                                                    "parent_sample_sha1": {
                                                                                        "items": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "type": "array"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "ripemd160": {
                                                                                "type": "string"
                                                                            },
                                                                            "sample_size": {
                                                                                "type": "integer"
                                                                            },
                                                                            "sha1": {
                                                                                "type": "string"
                                                                            },
                                                                            "sha256": {
                                                                                "type": "string"
                                                                            },
                                                                            "sha384": {
                                                                                "type": "string"
                                                                            },
                                                                            "sha512": {
                                                                                "type": "string"
                                                                            },
                                                                            "sources": {
                                                                                "properties": {
                                                                                    "entries": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "properties": {
                                                                                                    "items": {
                                                                                                        "properties": {
                                                                                                            "name": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "value": {
                                                                                                                "type": "string"
                                                                                                            }
                                                                                                        },
                                                                                                        "required": [
                                                                                                            "name",
                                                                                                            "value"
                                                                                                        ],
                                                                                                        "type": "object"
                                                                                                    },
                                                                                                    "type": "array"
                                                                                                },
                                                                                                "record_time": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "tag": {
                                                                                                    "type": "string"
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "record_time",
                                                                                                "tag"
                                                                                            ],
                                                                                            "type": "object"
                                                                                        },
                                                                                        "type": "array"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "ssdeep": {
                                                                                "type": "string"
                                                                            },
                                                                            "xref": {
                                                                                "properties": {
                                                                                    "entries": {
                                                                                        "items": {
                                                                                            "properties": {
                                                                                                "info": {
                                                                                                    "properties": {
                                                                                                        "scanners": {
                                                                                                            "items": {
                                                                                                                "properties": {
                                                                                                                    "name": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "timestamp": {
                                                                                                                        "type": "string"
                                                                                                                    },
                                                                                                                    "version": {
                                                                                                                        "type": "string"
                                                                                                                    }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                    "name",
                                                                                                                    "version",
                                                                                                                    "timestamp"
                                                                                                                ],
                                                                                                                "type": "object"
                                                                                                            },
                                                                                                            "type": "array"
                                                                                                        }
                                                                                                    },
                                                                                                    "type": "object"
                                                                                                },
                                                                                                "record_time": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "scanners": {
                                                                                                    "items": {
                                                                                                        "properties": {
                                                                                                            "name": {
                                                                                                                "type": "string"
                                                                                                            },
                                                                                                            "result": {
                                                                                                                "type": "string"
                                                                                                            }
                                                                                                        },
                                                                                                        "required": [
                                                                                                            "name",
                                                                                                            "result"
                                                                                                        ],
                                                                                                        "type": "object"
                                                                                                    },
                                                                                                    "type": "array"
                                                                                                }
                                                                                            },
                                                                                            "required": [
                                                                                                "record_time",
                                                                                                "scanners",
                                                                                                "info"
                                                                                            ],
                                                                                            "type": "object"
                                                                                        },
                                                                                        "type": "array"
                                                                                    },
                                                                                    "first_seen": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "last_seen": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "sample_type": {
                                                                                        "type": "string"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    }
                                                                },
                                                                "type": "object"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "Switch_-_reason": {
                                                "runAfter": {
                                                    "Get_File_Hash_Analysis_Detail": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "cases": {
                                                    "Case": {
                                                        "case": "best_source",
                                                        "actions": {
                                                            "Set_variable_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "classification_reason",
                                                                    "value": "the sample can be obtained from a trusted source, or it was unpacked from a file originating from a trusted source"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "Case_2": {
                                                        "case": "antivirus",
                                                        "actions": {
                                                            "Set_variable_3": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "classification_reason",
                                                                    "value": "the sample was classified by the ReversingLabs multi-scan algorithm based on aggregated antivirus scan results"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "Case_3": {
                                                        "case": "best_certificate",
                                                        "actions": {
                                                            "Set_variable_4": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "classification_reason",
                                                                    "value": "the sample or its container are signed with a valid and trusted certificate"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "Case_4": {
                                                        "case": "analyst_sample_override",
                                                        "actions": {
                                                            "Set_variable_5": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "classification_reason",
                                                                    "value": "the sample was classified manually after an analysis"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "Case_5": {
                                                        "case": "TC_certificate",
                                                        "actions": {
                                                            "Set_variable_6": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "classification_reason",
                                                                    "value": "the sample is signed with a recognized whitelisted certificate"
                                                                }
                                                            }
                                                        }
                                                    }
                                                },
                                                "default": {
                                                    "actions": {}
                                                },
                                                "expression": "@body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['reason']",
                                                "type": "Switch"
                                            },
                                            "Switch_-_status": {
                                                "runAfter": {
                                                    "For_each_Analysis_story": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "cases": {
                                                    "Case": {
                                                        "case": "MALICIOUS",
                                                        "actions": {
                                                            "Append_to_string_variable_malicious": {
                                                                "runAfter": {
                                                                    "Compose_malicious_reputation": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "type": "AppendToStringVariable",
                                                                "inputs": {
                                                                    "name": "results_body",
                                                                    "value": "@outputs('Compose_malicious_reputation')"
                                                                }
                                                            },
                                                            "Compose_malicious_reputation": {
                                                                "runAfter": {},
                                                                "type": "Compose",
                                                                "inputs": "<tr>\n  <td style=\"font-weight: bold;\">Hash (@{items('For_each_-_File_hash_reputation')?['Algorithm']})</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['query_hash']?['sha256']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status</td>\n  <td style=\"background-color: red; font-weight: bold; color: white\">@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status Description</td>\n  <td>The sample was classified as malicious by ReversingLabs proprietary algorithms. This classification is reserved for high-accuracy heuristics and named threats, such as Emotet, Dridex and WannaCry. Threat severity is expressed through the threat level value on a scale of 1-5. The higher the value, the more severe the threat.</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Threat Name</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['threat_name']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Threat Level</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['threat_level']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Reason</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['reason']} - @{variables('classification_reason')}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">File Details</td>\n  <td>@{variables('analysis_story')}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Scanner Detection</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['scanner_match']} of @{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['scanner_count']} scanners detected this file</td>\n</tr>"
                                                            }
                                                        }
                                                    },
                                                    "Case_2": {
                                                        "case": "KNOWN",
                                                        "actions": {
                                                            "Append_to_string_variable_known": {
                                                                "runAfter": {
                                                                    "Compose_known_reputation": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "type": "AppendToStringVariable",
                                                                "inputs": {
                                                                    "name": "results_body",
                                                                    "value": "@outputs('Compose_known_reputation')"
                                                                }
                                                            },
                                                            "Compose_known_reputation": {
                                                                "runAfter": {},
                                                                "type": "Compose",
                                                                "inputs": "<tr>\n  <td style=\"font-weight: bold;\">Hash (@{items('For_each_-_File_hash_reputation')?['Algorithm']})</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['query_hash']?['sha256']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status</td>\n  <td style=\"background-color: green; font-weight: bold; color: white\">@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status Description</td>\n  <td>The sample is presumed to be benign by ReversingLabs. The sample does not have any AV detections from trustworthy sources and it does not match any of our internal threat signatures. We recommend checking the trust factor of the sample. A low trust factor (4 or 5 on a scale of 0 to 5, with 0 being highest trust) indicates the source is not trusted. On the other hand, samples with high trust factor values (0, 1, or 2) come from prominent software vendors.</td>\n<tr>\n  <td style=\"font-weight: bold;\">Trust Factor</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['trust_factor']}</td>\n</tr>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Reason</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['reason']} - @{variables('classification_reason')}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Details</td>\n  <td>@{variables('analysis_story')}</td>\n</tr>"
                                                            }
                                                        }
                                                    },
                                                    "Case_3": {
                                                        "case": "SUSPICIOUS",
                                                        "actions": {
                                                            "Append_to_string_variable_suspicious": {
                                                                "runAfter": {
                                                                    "Compose_suspicious_reputation": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "type": "AppendToStringVariable",
                                                                "inputs": {
                                                                    "name": "results_body",
                                                                    "value": "@outputs('Compose_suspicious_reputation')"
                                                                }
                                                            },
                                                            "Compose_suspicious_reputation": {
                                                                "runAfter": {},
                                                                "type": "Compose",
                                                                "inputs": "<tr>\n  <td style=\"font-weight: bold;\">Hash (@{items('For_each_-_File_hash_reputation')?['Algorithm']})</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['query_hash']?['sha256']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status</td>\n  <td style=\"background-color: orange; font-weight: bold; color: black\">@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Status Description</td>\n  <td>The sample is considered suspicious based on ReversingLabs classification algorithm’s multi-level analysis. This file may be declared malicious or known at a later time when more reliable heuristics start detecting the file, when a threat specific signature is written, or any new information is received that changes its threat profile.</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Threat Name</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['threat_name']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Threat Level</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['threat_level']}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Reason</td>\n  <td>@{body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['reason']} - @{variables('classification_reason')}</td>\n</tr>\n<tr>\n  <td style=\"font-weight: bold;\">Details</td>\n  <td>@{variables('analysis_story')}</td>\n</tr>"
                                                            }
                                                        }
                                                    }
                                                },
                                                "default": {
                                                    "actions": {}
                                                },
                                                "expression": "@body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']",
                                                "type": "Switch"
                                            }
                                        }
                                    },
                                    "expression": {
                                        "and": [
                                            {
                                                "equals": [
                                                    "@body('Parse_hash_reputation_JSON')?['rl']?['malware_presence']?['status']",
                                                    "UNKNOWN"
                                                ]
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "Get_File_Hash_Reputation": {
                                    "runAfter": {},
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "headers": {
                                            "User-Agent": "ReversingLabs Azure Connector TiCloud v1.0.0"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['reversinglabsintelligence']['connectionId']"
                                            }
                                        },
                                        "method": "get",
                                        "path": "/api/databrowser/malware_presence/query/@{encodeURIComponent(toLower(string(items('For_each_-_File_hash_reputation')?['Algorithm'])))}/@{encodeURIComponent(items('For_each_-_File_hash_reputation')?['Value'])}",
                                        "queries": {
                                            "extended": true,
                                            "format": "json",
                                            "show_hashes": true
                                        }
                                    }
                                },
                                "Parse_hash_reputation_JSON": {
                                    "runAfter": {
                                        "Get_File_Hash_Reputation": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ParseJson",
                                    "inputs": {
                                        "content": "@body('Get_File_Hash_Reputation')",
                                        "schema": {
                                            "properties": {
                                                "rl": {
                                                    "properties": {
                                                        "malware_presence": {
                                                            "properties": {
                                                                "classification": {
                                                                    "properties": {
                                                                        "family_name": {
                                                                            "type": "string"
                                                                        },
                                                                        "is_generic": {
                                                                            "type": "boolean"
                                                                        },
                                                                        "platform": {
                                                                            "type": "string"
                                                                        },
                                                                        "type": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "first_seen": {
                                                                    "type": "string"
                                                                },
                                                                "last_seen": {
                                                                    "type": "string"
                                                                },
                                                                "query_hash": {
                                                                    "properties": {
                                                                        "sha256": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "reason": {
                                                                    "type": "string"
                                                                },
                                                                "scanner_count": {
                                                                    "type": "integer"
                                                                },
                                                                "scanner_match": {
                                                                    "type": "integer"
                                                                },
                                                                "scanner_percent": {
                                                                    "type": "number"
                                                                },
                                                                "status": {
                                                                    "type": "string"
                                                                },
                                                                "threat_level": {
                                                                    "type": "integer"
                                                                },
                                                                "threat_name": {
                                                                    "type": "string"
                                                                },
                                                                "trust_factor": {
                                                                    "type": "integer"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    }
                                },
                                "Set_comment_logo": {
                                    "runAfter": {
                                        "Close_results_table": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Compose",
                                    "inputs": "<svg x=\"0px\" y=\"0px\"\n\t viewBox=\"50 150 7041.9 295.3\" style=\"enable-background:new 50 150 7041.9 295.3; \" xml:space=\"preserve\">\n<g>\n\t<g>\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M279.3,303.1h-30.8l-27.9,92.2H173v-92.2h-20.6v109.6h84l9.7-30.7h35.2l9.4,30.7h22.5L279.3,303.1z M250,365\n\t\t\tl9.3-30.2c1.6-5.5,2.7-11.4,3.8-17.3h1.3c1,5.9,2.2,11.8,3.8,17.3l9.1,30.2H250z\"/>\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M349.8,413.5c-12.5,0-17.8-0.3-31.7-0.9V303.1c14.5-0.6,19.8-0.9,32.3-0.9c29.3,0,47.5,5.2,47.5,29.8v1.3\n\t\t\tc0,9.4-4.1,18.6-13.9,23c10.3,4.3,14.5,13.7,14.5,23.1v1.5C398.5,408.3,378.1,413.5,349.8,413.5 M377.8,332.7\n\t\t\tc0-12.5-9.9-13.6-27.4-13.6h-12.2v29.7h18.6c17,0,21.1-5.6,21.1-14.7V332.7z M378.3,379.3c-0.1-9.6-4.6-15.6-21.4-15.6h-18.7v32.9\n\t\t\th5.6c22.4,0,34.5-0.1,34.5-15.6V379.3z\"/>\n\t\t<path class=\"st0\" style=\"fill:#F6143F\" d=\"M446,415c-14.3,0-29.1-1.9-34.5-3.4v-15.8c9,0.9,19.2,1.8,32.9,1.8c13.3,0,19.6-3.7,19.6-13.6\n\t\t\tc0-7.1-2.8-11.1-13.7-15.6l-16.5-6.8c-16.2-6.6-24.9-15.9-24.9-31.9c0-21.2,13.3-28.9,39.2-28.9c13.8,0,26.8,2.2,32,3.5V320\n\t\t\tc-8.4-0.7-19.6-1.9-31.1-1.9c-12.8,0-19.8,2.2-19.8,11.1c0,6.6,3.1,10,14,14.5l14.9,6.1c19.2,7.8,26.8,15.6,26.8,34.2\n\t\t\tC484.9,403.8,470.6,415,446,415\"/>\n\t</g>\n\t<g>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M52.9,292.1l25.8-44.7c-11.7-5-18.9-13.7-18.9-30.4v-1c0-28.9,21.8-34.2,48.2-34.2c11.1,0,21,0.3,30.7,0.7\n\t\t\tv109.6h-20.1v-40.4h-10.2c-3.4,0-6.6,0-9.6-0.1l-24.2,40.6H52.9z M80,217.2c0,14.2,8.4,18.1,27.3,18.1c3.8,0,7.5,0,11.4-0.2v-36\n\t\t\tc-26.8,0-38.6,0.2-38.6,17.1V217.2z\"/>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M291.5,182.5l-22.6,75.9c-1.9,6.4-3.2,13.7-4.4,19.6h-0.3c-1.5-5.8-2.5-13.3-4.4-19.6l-22.6-75.9h-84.9v109.6\n\t\t\th69.8v-16.9H173V244h46v-16.5h-46v-27.9h48.1l27.9,92.5h30.1l33.2-109.6H291.5z\"/>\n\t\t<polygon class=\"st1\" style=\"fill:#231F20\" points=\"318,292.1 318,182.5 387.7,182.5 387.7,199.6 338.6,199.6 338.6,227.5 384.6,227.5 384.6,244 \n\t\t\t338.6,244 338.6,275.1 387.7,275.1 387.7,292.1 \t\t\"/>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M463.7,292.1l-24.2-40.5c-2.9,0.1-6.2,0.1-9.6,0.1h-10.2v40.4h-20.1V182.5c9.7-0.4,19.6-0.7,30.7-0.7\n\t\t\tc26.4,0,48.2,5.3,48.2,34.2v1c0,16.7-7.2,25.4-18.9,30.4l25.8,44.7H463.7z M458.4,216.3c0-17-11.8-17.1-38.6-17.1v36\n\t\t\tc3.8,0.2,7.5,0.2,11.4,0.2c18.9,0,27.3-4,27.3-18.1V216.3z\"/>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M525.1,294.5c-14.3,0-29.1-1.9-34.5-3.4v-15.8c9,0.9,19.2,1.8,32.9,1.8c13.3,0,19.6-3.7,19.6-13.6\n\t\t\tc0-7.1-2.8-11.1-13.7-15.6l-16.5-6.8c-16.2-6.6-24.9-15.9-24.9-31.9c0-21.2,13.3-28.9,39.2-28.9c13.9,0,26.8,2.2,32,3.5v15.6\n\t\t\tc-8.4-0.7-19.6-1.9-31.1-1.9c-12.8,0-19.8,2.2-19.8,11.1c0,6.6,3.1,10,14,14.5l14.9,6c19.2,7.8,26.8,15.6,26.8,34.2\n\t\t\tC564,283.2,549.7,294.5,525.1,294.5\"/>\n\t\t<rect x=\"573\" y=\"182.5\" class=\"st1\" style=\"fill:#231F20\" width=\"20.6\" height=\"109.6\"/>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M671.5,292.1l-35.1-65c-2.7-5-5.8-10.9-8.3-16.4h-0.3c0.3,6.2,0.6,13,0.6,19.6v61.8h-18.9V182.5h23.9l35,63.7\n\t\t\tc2.6,5,6,11.4,8.4,16.7h0.3c-0.5-6.5-0.6-14.2-0.6-20.8v-59.6h19v109.6H671.5z\"/>\n\t\t<path class=\"st1\" style=\"fill:#231F20\" d=\"M753.2,294.5c-25.1,0-45.9-9.7-45.9-49.4v-15.5c0-41.9,23.6-49.3,46.3-49.3c16.1,0,31.9,2.7,35.2,3.7v15.8\n\t\t\tc-7.1-0.6-24.2-1.5-31.7-1.5c-17.8,0-29.3,4-29.3,31.3V245c0,25.1,9.1,31.4,26.8,31.4c5.5,0,10.9-0.2,14.7-0.4v-26.6l-8.4,0v-15.7\n\t\t\th28v57.4C783,292.4,769,294.5,753.2,294.5\"/>\n\t</g>\n</g>\n</svg>\n"
                                },
                                "Set_variable": {
                                    "runAfter": {
                                        "Clear_results_body_variable": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "results_comment",
                                        "value": "<table>\n  <tr>"
                                    }
                                }
                            },
                            "runAfter": {
                                "Initialize_classification_reason": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach",
                            "runtimeConfiguration": {
                                "concurrency": {
                                    "repetitions": 1
                                }
                            }
                        },
                        "Initialize_analysis_story": {
                            "runAfter": {
                                "Initialize_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "analysis_story",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_classification_reason": {
                            "runAfter": {
                                "Initialize_analysis_story": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "classification_reason",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "Initialize_results_table": {
                            "runAfter": {
                                "Entities_-_Get_FileHashes": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "results_comment",
                                        "type": "string",
                                        "value": "<table>\n  <tr>"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable": {
                            "runAfter": {
                                "Initialize_results_table": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "results_body",
                                        "type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azuresentinel": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                                "connectionName": "azuresentinel",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
                            },
                            "reversinglabsintelligence": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('ReversingLabsConnectionName'))]",
                                "connectionName": "reversinglabsintelligence",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/reversinglabsintelligence')]"
                            }
                        }
                    }
                }
            }
        }
    ]
}
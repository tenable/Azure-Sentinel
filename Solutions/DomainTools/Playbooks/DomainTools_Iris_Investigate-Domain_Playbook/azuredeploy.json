{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "metadata": {
        "title": "Domain Enrichment - DomainTools Iris Investigate", 
        "description": "Given a domain or set of domains associated with an incident return all Iris Investigate data for those domains as comments in the incident.",
        "prerequisites": "A DomainTools API Key provisioned for Iris Investigate. Visit https://www.domaintools.com/integrations to request a trial key.",
        "lastUpdateTime": "2022-09-24T00:00:00.000Z", 
        "entities": ["host"], 
        "tags": ["Enrichment"], 
        "support": {
            "tier": "community" 
        },
        "author": {
            "name": "Dan Nunes, DomainTools"
        }
    },
    "parameters": {
        "PlaybookName": {
            "defaultValue": "DomainTools_Iris_Investigate-Domain_Playbook",
            "type": "string"
        },
        "UserName": {
            "defaultValue": "<username>@<domain>",
            "type": "string"
        }
    },
    "variables": {
		"DomainToolsApiKey": "[concat('domaintoolsirisinves-', parameters('PlaybookName'))]",
		"AzureSentinelConnectionName": "[concat('azuresentinel-', parameters('PlaybookName'))]"
	},
    "resources": [
        {
			"type": "Microsoft.Web/connections",
			"apiVersion": "2016-06-01",
			"name": "[variables('AzureSentinelConnectionName')]",
			"location": "[resourceGroup().location]",
			"kind": "V1",
			"properties": {
				"displayName": "[variables('AzureSentinelConnectionName')]",
				"customParameterValues": {},
				"parameterValueType": "Alternative",
				"api": {
					"id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]"
				}
			}
		},
		{
			"type": "Microsoft.Web/connections",
			"apiVersion": "2016-06-01",
			"name": "[variables('DomainToolsApiKey')]",
			"location": "[resourceGroup().location]",
			"properties": {
				"displayName": "[parameters('UserName')]",
				"customParameterValues": {},
				"api": {
					"id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/farsightdnsdb')]"
                }
            }
        },
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('PlaybookName')]",
            "location": "[resourceGroup().location]",
			"identity": {
				"type": "SystemAssigned"
			},
			"dependsOn": [
				"[resourceId('Microsoft.Web/connections', variables('DomainToolsApiKey'))]",
				"[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]"
			],
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        },
                        "Pivot Threshold": {
                            "defaultValue": 500,
                            "type": "Int"
                        }
                    },
                    "triggers": {
                        "Microsoft_Sentinel_incident": {
                            "type": "ApiConnectionWebhook",
                            "inputs": {
                                "body": {
                                    "callback_url": "@{listCallbackUrl()}"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "path": "/incident-creation"
                            }
                        }
                    },
                    "actions": {
                        "DNS_Name_Variable": {
                            "runAfter": {
                                "Host_Name_Variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "dns_name",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "Domain_Name_Variable": {
                            "runAfter": {
                                "DNS_Name_Variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "domain_name",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "Entities_-_Get_Hosts": {
                            "runAfter": {
                                "count_url_link_03": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/entities/host"
                            }
                        },
                        "For_each_Host": {
                            "foreach": "@body('Entities_-_Get_Hosts')?['Hosts']",
                            "actions": {
                                "Check_DNS_Name_is_empty": {
                                    "actions": {
                                        "Set_Domain_Name_Variable": {
                                            "runAfter": {},
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "domain_name",
                                                "value": "@{variables('host_name')}.@{variables('dns_name')}"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Set_DNS_Name_Variable": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Set_variable": {
                                                "runAfter": {},
                                                "type": "SetVariable",
                                                "inputs": {
                                                    "name": "domain_name",
                                                    "value": "@variables('host_name')"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "and": [
                                            {
                                                "not": {
                                                    "equals": [
                                                        "@variables('dns_name')",
                                                        ""
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "Check_if_results_exists": {
                                    "actions": {
                                        "Results_Loop": {
                                            "foreach": "@body('Investigate_Domain')?['response']?['results']",
                                            "actions": {
                                                "Add_comment_to_incident_(V3)": {
                                                    "runAfter": {
                                                        "Technical_Contact_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "ApiConnection",
                                                    "inputs": {
                                                        "body": {
                                                            "incidentArmId": "@triggerBody()?['object']?['id']",
                                                            "message": "<p><span style=\"font-size: 16px\"><strong>DomainTools IRIS Investigate response for:</strong></span><span style=\"font-size: 16px\">@{variables('domain_name')}</span><span style=\"font-size: 16px\"></span><br>\n@{replace(replace(replace(body('Domain_detailts_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Domain_Risk_Score_Components_Table') , '&quot;', ''),']','') , '[', '') }@{replace(replace(replace(body('miscellaneouos_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('IP_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('MX_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Nameserver_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('SSL_Info_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Admin_Contact_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Billing_Contact_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Registrant_Contact_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}@{replace(replace(replace(body('Technical_Contact_Table'), '&lt;', '<'), '&gt;', '>'),'&quot;','')}<br>\n<br>\n<br>\nFind more details: https://research.domaintools.com/iris/search/?q=@{variables('domain_name')}</p>"
                                                        },
                                                        "host": {
                                                            "connection": {
                                                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                            }
                                                        },
                                                        "method": "post",
                                                        "path": "/Incidents/Comment"
                                                    }
                                                },
                                                "Admin_Contact_Compose": {
                                                    "runAfter": {
                                                        "Check_admin_Contact_Fax_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Admin Contact City": "@variables('admin_contact_city_value')",
                                                        "Admin Contact Country": "@variables('admin_contact_country_value')",
                                                        "Admin Contact Email": "@substring(variables('admin_contact_email'),0,sub(length(variables('admin_contact_email')),1))",
                                                        "Admin Contact Fax": "@variables('admin_contact_fax_value')",
                                                        "Admin Contact Name": "@variables('admin_contact_name_value')",
                                                        "Admin Contact Org": "@variables('admin_contact_org_value')",
                                                        "Admin Contact Phone": "@variables('admin_contact_phone_value')",
                                                        "Admin Contact Postal": "@variables('admin_contact_postal_value')",
                                                        "Admin Contact State": "@variables('admin_contact_state_value')",
                                                        "Admin Contact Street": "@variables('admin_contact_street_value')"
                                                    }
                                                },
                                                "Admin_Contact_Table": {
                                                    "runAfter": {
                                                        "SSL_Info_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('admin_contact_details')"
                                                    }
                                                },
                                                "Append_to__Domain_Details_array": {
                                                    "runAfter": {
                                                        "_Domain_Details_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "domain_details_array",
                                                        "value": "@outputs('_Domain_Details_Compose')"
                                                    }
                                                },
                                                "Append_to_admin_contact_array": {
                                                    "runAfter": {
                                                        "Admin_Contact_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "admin_contact_details",
                                                        "value": "@outputs('Admin_Contact_Compose')"
                                                    }
                                                },
                                                "Append_to_billing_contact_array": {
                                                    "runAfter": {
                                                        "Billing_Contact_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "billing_contact_details",
                                                        "value": "@outputs('Billing_Contact_Compose')"
                                                    }
                                                },
                                                "Append_to_miscellaneous_array_variable": {
                                                    "runAfter": {
                                                        "Miscellaneous_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "Miscellaneous",
                                                        "value": "@outputs('Miscellaneous_Compose')"
                                                    }
                                                },
                                                "Append_to_registrant_contact_array": {
                                                    "runAfter": {
                                                        "Registrant_Contact_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "registrant_contact_details",
                                                        "value": "@outputs('Registrant_Contact_Compose')"
                                                    }
                                                },
                                                "Append_to_techinical_contact_array": {
                                                    "runAfter": {
                                                        "Technical_Contact_Compose": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "AppendToArrayVariable",
                                                    "inputs": {
                                                        "name": "technical_contact_details",
                                                        "value": "@outputs('Technical_Contact_Compose')"
                                                    }
                                                },
                                                "Billing_Contact_Compose": {
                                                    "runAfter": {
                                                        "Check_billing_Contact_Fax_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Billing Contact City": "@variables('billing_contact_city_value')",
                                                        "Billing Contact Country": "@variables('billing_contact_country_value')",
                                                        "Billing Contact Email": "@substring(variables('billing_contact_email'),0,sub(length(variables('billing_contact_email')),1))",
                                                        "Billing Contact Fax": "@variables('billing_contact_fax_value')",
                                                        "Billing Contact Name": "@variables('billing_contact_name_value')",
                                                        "Billing Contact Org": "@variables('billing_contact_org_value')",
                                                        "Billing Contact Phone": "@variables('billing_contact_phone_value')",
                                                        "Billing Contact Postal": "@variables('billing_contact_postal_value')",
                                                        "Billing Contact State": "@variables('billing_contact_state_value')",
                                                        "Billing Contact Street": "@variables('billing_contact_street_value')"
                                                    }
                                                },
                                                "Billing_Contact_Table": {
                                                    "runAfter": {
                                                        "Admin_Contact_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('billing_contact_details')"
                                                    }
                                                },
                                                "Check_Adsense_Count": {
                                                    "actions": {
                                                        "Set_Adsense_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['adsense']?['value'],variables('count_url_end_03')),items('Results_Loop')?['adsense']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_adsense_value_1": {
                                                            "runAfter": {
                                                                "Set_Adsense_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "adsense_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Set_count_url_link_2": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_adsense_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "adsense_value",
                                                                    "value": "@items('Results_Loop')?['adsense']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['adsense']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['adsense']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Create_Date_Count": {
                                                    "actions": {
                                                        "Set_Create_Date_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['create_date']?['value'],variables('count_url_end_03')),items('Results_Loop')?['create_date']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_Create_Date_value_1": {
                                                            "runAfter": {
                                                                "Set_Create_Date_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "create_date_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Adsense_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_Create_Date_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "create_date_value",
                                                                    "value": "@items('Results_Loop')?['create_date']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['create_date']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['create_date']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Expiration_Date_Count": {
                                                    "actions": {
                                                        "Set_Expiration_Date_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['expiration_date']?['value'],variables('count_url_end_03')),items('Results_Loop')?['expiration_date']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_Expiration_Date_value_1": {
                                                            "runAfter": {
                                                                "Set_Expiration_Date_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "expiration_date_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Create_Date_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_Expiration_Date_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "expiration_date_value",
                                                                    "value": "@items('Results_Loop')?['expiration_date']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['expiration_date']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['expiration_date']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Redirect_Count": {
                                                    "actions": {
                                                        "Set_Redirect_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['redirect']?['value'],variables('count_url_end_03')),items('Results_Loop')?['redirect']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_Redirect_value_1": {
                                                            "runAfter": {
                                                                "Set_Redirect_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "redirect_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Expiration_Date_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_Redirect_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "redirect_value",
                                                                    "value": "@items('Results_Loop')?['redirect']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['redirect']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['redirect']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Redirect_Domain_Count": {
                                                    "actions": {
                                                        "Set_Redirect_Domain_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['redirect_domain']?['value'],variables('count_url_end_03')),items('Results_Loop')?['redirect_domain']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_Redirect_Domain_value_1": {
                                                            "runAfter": {
                                                                "Set_Redirect_Domain_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "redirect_domain_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Redirect_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_Redirect_Domain_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "redirect_domain_value",
                                                                    "value": "@items('Results_Loop')?['redirect_domain']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['redirect_domain']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['redirect_domain']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_City_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_City_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['city']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['city']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_city_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_City_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_city_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Street_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_city_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_city_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['city']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['city']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['city']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Country_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Country_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['country']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['country']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_country_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Country_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_country_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Postal_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_country_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_country_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['country']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['country']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['country']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Fax_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Fax_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['fax']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['fax']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_fax_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Fax_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_fax_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Phone_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_fax_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_fax_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['fax']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['fax']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['fax']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Name_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Name_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['name']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['name']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_name_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Name_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_name_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_Registrant_Contact_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_name_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_name_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['name']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['name']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['name']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Org_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Org_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['org']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['org']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_org_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Org_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_org_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Name_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_org_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_org_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['org']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['org']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['org']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Phone_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Phone_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['phone']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['phone']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_phone_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Phone_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_phone_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Country_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_phone_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_phone_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['phone']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['phone']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['phone']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Postal_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Postal_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['postal']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['postal']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_postal_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Postal_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_postal_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_State_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_postal_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_postal_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['postal']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['postal']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['postal']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_State_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_State_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['state']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['state']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_state_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_State_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_state_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_City_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_state_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_state_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['state']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['state']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['state']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_Registrant_Contact_Street_Count": {
                                                    "actions": {
                                                        "Set_Registrant_Contact_Street_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_contact']?['street']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_contact']?['street']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_registrant_contact_street_value_with_link": {
                                                            "runAfter": {
                                                                "Set_Registrant_Contact_Street_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_contact_street_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Org_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_registrant_contact_street_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_contact_street_value",
                                                                    "value": "@items('Results_Loop')?['registrant_contact']?['street']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['street']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_contact']?['street']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_City_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_City_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['city']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['city']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_city_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_City_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_city_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Street_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_city_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_city_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['city']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['city']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['city']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Country_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Country_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['country']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['country']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_country_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Country_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_country_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Postal_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_country_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_country_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['country']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['country']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['country']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Fax_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Fax_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['fax']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['fax']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_fax_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Fax_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_fax_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Phone_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_fax_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_fax_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['fax']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['fax']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['fax']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Name_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Name_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['name']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['name']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_name_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Name_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_name_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_Admin_Contact_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_name_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_name_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['name']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['name']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['name']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Org_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Org_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['org']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['org']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_org_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Org_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_org_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Name_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_org_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_org_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['org']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['org']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['org']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Phone_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Phone_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['phone']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['phone']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_phone_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Phone_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_phone_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Country_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_phone_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_phone_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['phone']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['phone']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['phone']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Postal_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Postal_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['postal']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['postal']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_postal_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Postal_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_postal_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_State_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_postal_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_postal_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['postal']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['postal']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['postal']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_State_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_State_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['state']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['state']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_state_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_State_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_state_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_City_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_state_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_state_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['state']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['state']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['state']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_admin_Contact_Street_Count": {
                                                    "actions": {
                                                        "Set_admin_Contact_Street_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['admin_contact']?['street']?['value'],variables('count_url_end_03')),items('Results_Loop')?['admin_contact']?['street']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_admin_contact_street_value_with_link": {
                                                            "runAfter": {
                                                                "Set_admin_Contact_Street_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "admin_contact_street_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_admin_Contact_Org_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_admin_contact_street_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "admin_contact_street_value",
                                                                    "value": "@items('Results_Loop')?['admin_contact']?['street']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['admin_contact']?['street']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['admin_contact']?['street']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_City_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_City_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['city']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['city']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_city_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_City_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_city_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Street_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_city_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_city_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['city']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['city']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['city']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Country_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Country_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['country']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['country']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_country_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Country_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_country_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Postal_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_country_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_country_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['country']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['country']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['country']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Fax_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Fax_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['fax']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['fax']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_fax_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Fax_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_fax_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Phone_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_fax_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_fax_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['fax']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['fax']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['fax']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Name_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Name_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['name']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['name']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_name_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Name_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_name_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_Billing_Contact_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_name_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_name_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['name']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['name']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['name']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Org_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Org_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['org']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['org']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_org_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Org_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_org_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Name_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_org_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_org_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['org']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['org']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['org']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Phone_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Phone_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['phone']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['phone']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_phone_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Phone_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_phone_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Country_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_phone_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_phone_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['phone']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['phone']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['phone']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Postal_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Postal_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['postal']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['postal']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_postal_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Postal_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_postal_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_State_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_postal_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_postal_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['postal']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['postal']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['postal']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_State_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_State_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['state']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['state']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_state_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_State_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_state_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_City_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_state_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_state_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['state']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['state']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['state']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_billing_Contact_Street_Count": {
                                                    "actions": {
                                                        "Set_billing_Contact_Street_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['billing_contact']?['street']?['value'],variables('count_url_end_03')),items('Results_Loop')?['billing_contact']?['street']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_billing_contact_street_value_with_link": {
                                                            "runAfter": {
                                                                "Set_billing_Contact_Street_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "billing_contact_street_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_billing_Contact_Org_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_billing_contact_street_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "billing_contact_street_value",
                                                                    "value": "@items('Results_Loop')?['billing_contact']?['street']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['billing_contact']?['street']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['billing_contact']?['street']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_registrant_name_Count": {
                                                    "actions": {
                                                        "Set_registrant_name_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_name']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_name']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_registrant_name_value_1": {
                                                            "runAfter": {
                                                                "Set_registrant_name_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_name_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_Redirect_Domain_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_registrant_name_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_name_value",
                                                                    "value": "@items('Results_Loop')?['registrant_name']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_name']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_name']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_registrant_org_Count": {
                                                    "actions": {
                                                        "Set_registrant_org_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrant_org']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrant_org']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "Set_registrant_org_value_1": {
                                                            "runAfter": {
                                                                "Set_registrant_org_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "registrant_org_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_registrant_name_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Set_registrant_org_value_2": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "registrant_org_value",
                                                                    "value": "@items('Results_Loop')?['registrant_org']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['registrant_org']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['registrant_org']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_City_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_City_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['city']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['city']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_city_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_City_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_city_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Street_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_city_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_city_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['city']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['city']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['city']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Country_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Country_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['country']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['country']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_country_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Country_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_country_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Postal_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_country_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_country_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['country']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['country']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['country']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Fax_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Fax_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['fax']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['fax']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_fax_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Fax_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_fax_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Phone_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_fax_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_fax_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['fax']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['fax']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['fax']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Name_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Name_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['name']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['name']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_name_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Name_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_name_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_Technical_Contact_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_name_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_name_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['name']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['name']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['name']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Org_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Org_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['org']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['org']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_org_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Org_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_org_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Name_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_org_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_org_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['org']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['org']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['org']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Phone_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Phone_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['phone']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['phone']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_phone_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Phone_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_phone_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Country_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_phone_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_phone_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['phone']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['phone']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['phone']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Postal_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Postal_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['postal']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['postal']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_postal_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Postal_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_postal_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_State_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_postal_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_postal_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['postal']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['postal']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['postal']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_State_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_State_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['state']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['state']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_state_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_State_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_state_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_City_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_state_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_state_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['state']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['state']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['state']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Check_technical_Contact_Street_Count": {
                                                    "actions": {
                                                        "Set_technical_Contact_Street_Count_link_3": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "count_url_link_03",
                                                                "value": "@{concat(concat(concat(concat(items('Results_Loop')?['technical_contact']?['street']?['value'],variables('count_url_end_03')),items('Results_Loop')?['technical_contact']?['street']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                            }
                                                        },
                                                        "set_technical_contact_street_value_with_link": {
                                                            "runAfter": {
                                                                "Set_technical_Contact_Street_Count_link_3": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "technical_contact_street_value",
                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Check_technical_Contact_Org_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "set_technical_contact_street_value_without_link": {
                                                                "runAfter": {},
                                                                "type": "SetVariable",
                                                                "inputs": {
                                                                    "name": "technical_contact_street_value",
                                                                    "value": "@items('Results_Loop')?['technical_contact']?['street']?['value']"
                                                                }
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@items('Results_Loop')?['technical_contact']?['street']?['count']",
                                                                    1
                                                                ]
                                                            },
                                                            {
                                                                "lessOrEquals": [
                                                                    "@items('Results_Loop')?['technical_contact']?['street']?['count']",
                                                                    "@variables('max_count')"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Condition": {
                                                    "actions": {
                                                        "Check_registrar_Count": {
                                                            "actions": {
                                                                "Set_registrar_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('Results_Loop')?['registrar']?['value'],variables('count_url_end_03')),items('Results_Loop')?['registrar']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                },
                                                                "Set_registrar_value_1": {
                                                                    "runAfter": {
                                                                        "Set_registrar_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "registrar_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Set_registrar_value_2": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "registrar_value",
                                                                            "value": "@items('Results_Loop')?['registrar']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('Results_Loop')?['registrar']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('Results_Loop')?['registrar']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Set_variable_2": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "greater": [
                                                                    "@length(variables('registrar_value'))",
                                                                    0
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "type": "If"
                                                },
                                                "Domain_Risk_Score_Components_Table": {
                                                    "runAfter": {
                                                        "Domain_detailts_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@items('Results_Loop')?['domain_risk']?['components']"
                                                    }
                                                },
                                                "Domain_detailts_Table": {
                                                    "runAfter": {
                                                        "Append_to_miscellaneous_array_variable": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('domain_details_array')"
                                                    }
                                                },
                                                "For_Each_Email_Domain": {
                                                    "foreach": "@items('Results_Loop')['email_domain']",
                                                    "actions": {
                                                        "Check_Email_Domain_Count": {
                                                            "actions": {
                                                                "Append_to_email_domains_variable_1": {
                                                                    "runAfter": {
                                                                        "Set_email_domains_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "email_domains",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_email_domains_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_Each_Email_Domain')?['value'],variables('count_url_end_03')),items('For_Each_Email_Domain')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_email_domains_variable_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "email_domains",
                                                                            "value": "@{items('For_Each_Email_Domain')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_Each_Email_Domain')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_Each_Email_Domain')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "set_email_domain_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Admin_Contact_Email": {
                                                    "foreach": "@items('Results_Loop')['admin_contact']['email']",
                                                    "actions": {
                                                        "Check_Admin_Contact_Email_Count": {
                                                            "actions": {
                                                                "Append_to_admin_contact_email": {
                                                                    "runAfter": {
                                                                        "Set_Admin_Contact_Email_Count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "admin_contact_email",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_Admin_Contact_Email_Count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Admin_Contact_Email')?['value'],variables('count_url_end_03')),items('For_each_Admin_Contact_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_admin_contact_email_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "admin_contact_email",
                                                                            "value": "@{items('For_each_Admin_Contact_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Admin_Contact_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Admin_Contact_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Append_to__Domain_Details_array": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Billing_Contact_Email": {
                                                    "foreach": "@items('Results_Loop')['billing_contact']['email']",
                                                    "actions": {
                                                        "Check_Billing_Contact_Email_Count": {
                                                            "actions": {
                                                                "Append_to_billing_contact_email": {
                                                                    "runAfter": {
                                                                        "Set_Billing_Contact_Email_Count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "billing_contact_email",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_Billing_Contact_Email_Count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Billing_Contact_Email')?['value'],variables('count_url_end_03')),items('For_each_Billing_Contact_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_billing_contact_email_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "billing_contact_email",
                                                                            "value": "@{items('For_each_Billing_Contact_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Billing_Contact_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Billing_Contact_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Append_to_admin_contact_array": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Name_Server": {
                                                    "foreach": "@items('Results_Loop')['name_server']",
                                                    "actions": {
                                                        "Append_to_array_variable": {
                                                            "runAfter": {
                                                                "Name_Server_Compose": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "nameservers",
                                                                "value": "@outputs('Name_Server_Compose')"
                                                            }
                                                        },
                                                        "Check_Nameserver_Domain": {
                                                            "actions": {
                                                                "Set_Nameserver_Domain_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Name_Server')?['domain']?['value'],variables('count_url_end_03')),items('For_each_Name_Server')?['domain']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                },
                                                                "Set_nameserver_domain_with_link": {
                                                                    "runAfter": {
                                                                        "Set_Nameserver_Domain_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "name_server_domain_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "For_each_namer_server_ip": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_nameserver_domain_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "name_server_domain_value",
                                                                            "value": "@items('For_each_Name_Server')?['domain']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Name_Server')?['domain']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Name_Server')?['domain']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_Nameserver_Host": {
                                                            "actions": {
                                                                "Set_nameserver_host_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Name_Server')?['host']?['value'],variables('count_url_end_03')),items('For_each_Name_Server')?['host']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                },
                                                                "Set_namserver_host_with_link": {
                                                                    "runAfter": {
                                                                        "Set_nameserver_host_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "name_server_host_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_Nameserver_Domain": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "set_nameserver_host_value_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "name_server_host_value",
                                                                            "value": "@{items('For_each_Name_Server')?['host']?['value']}"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Name_Server')?['host']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Name_Server')?['host']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "For_each_namer_server_ip": {
                                                            "foreach": "@items('For_each_Name_Server')['ip']",
                                                            "actions": {
                                                                "Check_Nameserver_IP_Count": {
                                                                    "actions": {
                                                                        "Append_to_name_server_ips_variable_with_link": {
                                                                            "runAfter": {
                                                                                "Set_NS_ips_link_3": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "type": "AppendToStringVariable",
                                                                            "inputs": {
                                                                                "name": "name_server_ip_value",
                                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                            }
                                                                        },
                                                                        "Set_NS_ips_link_3": {
                                                                            "runAfter": {},
                                                                            "type": "SetVariable",
                                                                            "inputs": {
                                                                                "name": "count_url_link_03",
                                                                                "value": "@{concat(concat(concat(concat(items('For_each_namer_server_ip')?['value'],variables('count_url_end_03')),items('For_each_namer_server_ip')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "else": {
                                                                        "actions": {
                                                                            "Append_to_name_server_ips_variable_without_link": {
                                                                                "runAfter": {},
                                                                                "type": "SetVariable",
                                                                                "inputs": {
                                                                                    "name": "name_server_ip_value",
                                                                                    "value": "@{items('For_each_namer_server_ip')?['value']},"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "expression": {
                                                                        "and": [
                                                                            {
                                                                                "greater": [
                                                                                    "@items('For_each_namer_server_ip')?['count']",
                                                                                    "@variables('max_count')"
                                                                                ]
                                                                            },
                                                                            {
                                                                                "lessOrEquals": [
                                                                                    "@items('For_each_namer_server_ip')?['count']",
                                                                                    "@variables('max_count')"
                                                                                ]
                                                                            }
                                                                        ]
                                                                    },
                                                                    "type": "If"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Set_name_server_ips_to_empty": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Foreach"
                                                        },
                                                        "Name_Server_Compose": {
                                                            "runAfter": {
                                                                "Check_Nameserver_Host": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Compose",
                                                            "inputs": {
                                                                "Nameserver Domain": "@variables('name_server_domain_value')",
                                                                "Nameserver Host": "@variables('name_server_host_value')",
                                                                "Nameserver IPs": "@substring(variables('name_server_ip_value'),0,sub(length(variables('name_server_ip_value')),1))"
                                                            }
                                                        },
                                                        "Set_name_server_ips_to_empty": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "name_server_ips",
                                                                "value": " "
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_mx": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Registrant_Contact_Email": {
                                                    "foreach": "@items('Results_Loop')['registrant_contact']['email']",
                                                    "actions": {
                                                        "Check_Registrant_Contact_Email_Count": {
                                                            "actions": {
                                                                "Append_to_registrant_contact_email": {
                                                                    "runAfter": {
                                                                        "Set_Registrant_Contact_Email_Count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "registrant_contact_email",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_Registrant_Contact_Email_Count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Registrant_Contact_Email')?['value'],variables('count_url_end_03')),items('For_each_Registrant_Contact_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_registrant_contact_email_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "registrant_contact_email",
                                                                            "value": "@{items('For_each_Registrant_Contact_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Registrant_Contact_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Registrant_Contact_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Append_to_billing_contact_array": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_SOA_Email": {
                                                    "foreach": "@items('Results_Loop')['soa_email']",
                                                    "actions": {
                                                        "Check_SOA_Email_Count": {
                                                            "actions": {
                                                                "Append_to_soa_email_variable_1": {
                                                                    "runAfter": {
                                                                        "Set_soa_emails_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "soa_emails",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_soa_emails_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_SOA_Email')?['value'],variables('count_url_end_03')),items('For_each_SOA_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_soa_email_variable_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "soa_emails",
                                                                            "value": "@{items('For_each_SOA_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_SOA_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_SOA_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "set_soa_email_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_SSL_Email": {
                                                    "foreach": "@items('Results_Loop')['ssl_email']",
                                                    "actions": {
                                                        "Check_SSL_Email_Count": {
                                                            "actions": {
                                                                "Append_to_SSL_Email_array_variable_1": {
                                                                    "runAfter": {
                                                                        "Set_ssl_emails_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "ssl_emails",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_ssl_emails_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_SSL_Email')?['value'],variables('count_url_end_03')),items('For_each_SSL_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_SSL_Email_array_variable_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "ssl_emails",
                                                                            "value": "@{items('For_each_SSL_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_SSL_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_SSL_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "set_ssl_email_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Tags": {
                                                    "foreach": "@items('Results_Loop')?['tags']",
                                                    "actions": {
                                                        "Append_to_string_variable": {
                                                            "runAfter": {},
                                                            "type": "AppendToStringVariable",
                                                            "inputs": {
                                                                "name": "tags",
                                                                "value": "@{items('For_each_Tags')?['label']},"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_adddtional_whois_email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_Technical_Contact_Email": {
                                                    "foreach": "@items('Results_Loop')['technical_contact']['email']",
                                                    "actions": {
                                                        "Check_Technical_Contact_Email_Count": {
                                                            "actions": {
                                                                "Append_to_technical_contact_email": {
                                                                    "runAfter": {
                                                                        "Set_Technical_Contact_Email_Count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "technical_contact_email",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_Technical_Contact_Email_Count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_Technical_Contact_Email')?['value'],variables('count_url_end_03')),items('For_each_Technical_Contact_Email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_to_technical_contact_email_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "technical_contact_email",
                                                                            "value": "@{items('For_each_Technical_Contact_Email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_Technical_Contact_Email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_Technical_Contact_Email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Append_to_registrant_contact_array": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_adddtional_whois_email": {
                                                    "foreach": "@items('Results_Loop')['additional_whois_email']",
                                                    "actions": {
                                                        "Check_Additional_Email_Count": {
                                                            "actions": {
                                                                "Append_toadddtional_whois_email_variable_1": {
                                                                    "runAfter": {
                                                                        "Set_Additional_emails_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "AppendToStringVariable",
                                                                    "inputs": {
                                                                        "name": "additional_whois_emails",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                    }
                                                                },
                                                                "Set_Additional_emails_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_adddtional_whois_email')?['value'],variables('count_url_end_03')),items('For_each_adddtional_whois_email')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Append_toadddtional_whois_email_variable_2": {
                                                                        "runAfter": {},
                                                                        "type": "AppendToStringVariable",
                                                                        "inputs": {
                                                                            "name": "additional_whois_emails",
                                                                            "value": "@{items('For_each_adddtional_whois_email')?['value']},"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_adddtional_whois_email')?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_adddtional_whois_email')?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "set_additonal_whois_email_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_ip": {
                                                    "foreach": "@items('Results_Loop')['ip']",
                                                    "actions": {
                                                        "Append_to_ips_array_variable": {
                                                            "runAfter": {
                                                                "IP_Compose": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "ips",
                                                                "value": "@outputs('IP_Compose')"
                                                            }
                                                        },
                                                        "Check_IP_Address_Count": {
                                                            "actions": {
                                                                "Set_IP_address_value_01": {
                                                                    "runAfter": {
                                                                        "Set_ip_address_count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ip_address_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_ip_address_count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ip')?['address']?['value'],variables('count_url_end_03')),items('For_each_ip')?['address']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "For_each_IP_Asn": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_IP_address_value_02": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ip_address_value",
                                                                            "value": "@items('For_each_ip')?['address']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ip')?['address']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ip')?['address']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_IP_Address_Country_Count": {
                                                            "actions": {
                                                                "Set_IP_Address_Country_value_01": {
                                                                    "runAfter": {
                                                                        "Set_ip_address_country_count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ip_country_code_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_ip_address_country_count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ip')?['country_code']?['value'],variables('count_url_end_03')),items('For_each_ip')?['country_code']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_IP_Address_Count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_IP_Address_Country_value_02": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ip_country_code_value",
                                                                            "value": "@items('For_each_ip')?['country_code']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ip')?['country_code']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ip')?['country_code']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_IP_Address_ISP_Count": {
                                                            "actions": {
                                                                "Set_IP_Address_ISP_value_01": {
                                                                    "runAfter": {
                                                                        "Set_ip_address_isp_count_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ip_isp_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_ip_address_isp_count_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ip')?['isp']?['value'],variables('count_url_end_03')),items('For_each_ip')?['isp']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_IP_Address_Country_Count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_IP_Address_ISP_value_02": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ip_isp_value",
                                                                            "value": "@items('For_each_ip')?['isp']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ip')?['isp']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ip')?['isp']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "For_each_IP_Asn": {
                                                            "foreach": "@items('For_each_ip')['asn']",
                                                            "actions": {
                                                                "Check_for_IP_ASN_Count": {
                                                                    "actions": {
                                                                        "Append_to_ips_asn_variable_1": {
                                                                            "runAfter": {
                                                                                "Set_ip_asn_link_03": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "type": "AppendToStringVariable",
                                                                            "inputs": {
                                                                                "name": "ips_asns",
                                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                            }
                                                                        },
                                                                        "Set_ip_asn_link_03": {
                                                                            "runAfter": {},
                                                                            "type": "SetVariable",
                                                                            "inputs": {
                                                                                "name": "count_url_link_03",
                                                                                "value": "@{concat(concat(concat(concat(items('For_each_IP_Asn')?['value'],variables('count_url_end_03')),items('For_each_IP_Asn')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "else": {
                                                                        "actions": {
                                                                            "Append_to_ips_asn_variable_2": {
                                                                                "runAfter": {},
                                                                                "type": "AppendToStringVariable",
                                                                                "inputs": {
                                                                                    "name": "ips_asns",
                                                                                    "value": "@{items('For_each_IP_Asn')?['value']},"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "expression": {
                                                                        "and": [
                                                                            {
                                                                                "greater": [
                                                                                    "@items('For_each_IP_Asn')?['count']",
                                                                                    1
                                                                                ]
                                                                            },
                                                                            {
                                                                                "lessOrEquals": [
                                                                                    "@items('For_each_IP_Asn')?['count']",
                                                                                    "@variables('max_count')"
                                                                                ]
                                                                            }
                                                                        ]
                                                                    },
                                                                    "type": "If"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Set_ips_asn_to_empty": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Foreach"
                                                        },
                                                        "IP_Compose": {
                                                            "runAfter": {
                                                                "Check_IP_Address_ISP_Count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Compose",
                                                            "inputs": {
                                                                "IP ASN": "@substring(variables('ips_asns'),0,sub(length(variables('ips_asns')),1))",
                                                                "IP Address": "@variables('ip_address_value')",
                                                                "IP Country Code": "@variables('ip_country_code_value')",
                                                                "IP ISP": "@variables('ip_isp_value')"
                                                            }
                                                        },
                                                        "Set_ips_asn_to_empty": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "ips_asns",
                                                                "value": " "
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Append_to_techinical_contact_array": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_mx": {
                                                    "foreach": "@items('Results_Loop')['mx']",
                                                    "actions": {
                                                        "Append_to_mxs_array_variable": {
                                                            "runAfter": {
                                                                "MX_Compose": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "mxs",
                                                                "value": "@outputs('MX_Compose')"
                                                            }
                                                        },
                                                        "Check_MX_Domain_Count": {
                                                            "actions": {
                                                                "Set_Mx_domain_value_with_link": {
                                                                    "runAfter": {
                                                                        "Set_vmx_domain_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "mx_domain_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_vmx_domain_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_mx')?['domain']?['value'],variables('count_url_end_03')),items('For_each_mx')?['domain']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "For_each_Mx_ip": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_Mx_domain_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "mx_domain_value",
                                                                            "value": "@items('For_each_mx')?['domain']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_mx')?['domain']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_mx')?['domain']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_MX_Host_Count": {
                                                            "actions": {
                                                                "Set_Mx_host_value_with_link": {
                                                                    "runAfter": {
                                                                        "Set_mx_host_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "mx_host_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_mx_host_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_mx')?['host']?['value'],variables('count_url_end_03')),items('For_each_mx')?['host']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_MX_Domain_Count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_Mx_host_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "mx_host_value",
                                                                            "value": "@items('For_each_mx')?['host']?['value']"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_mx')?['host']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_mx')?['host']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "For_each_Mx_ip": {
                                                            "foreach": "@items('For_each_mx')['ip']",
                                                            "actions": {
                                                                "Check_MX_IP_Count": {
                                                                    "actions": {
                                                                        "Append_to_mx_ips_variable_1": {
                                                                            "runAfter": {
                                                                                "Set_mx_ips_link_3": [
                                                                                    "Succeeded"
                                                                                ]
                                                                            },
                                                                            "type": "SetVariable",
                                                                            "inputs": {
                                                                                "name": "mx_ips",
                                                                                "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))},"
                                                                            }
                                                                        },
                                                                        "Set_mx_ips_link_3": {
                                                                            "runAfter": {},
                                                                            "type": "SetVariable",
                                                                            "inputs": {
                                                                                "name": "count_url_link_03",
                                                                                "value": "@{concat(concat(concat(concat(items('For_each_Mx_ip')?['value'],variables('count_url_end_03')),items('For_each_Mx_ip')?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                            }
                                                                        }
                                                                    },
                                                                    "runAfter": {},
                                                                    "else": {
                                                                        "actions": {
                                                                            "Append_to_mx_ips_variable_2": {
                                                                                "runAfter": {},
                                                                                "type": "AppendToStringVariable",
                                                                                "inputs": {
                                                                                    "name": "mx_ips",
                                                                                    "value": "@{items('For_each_Mx_ip')?['value']},"
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    "expression": {
                                                                        "and": [
                                                                            {
                                                                                "greater": [
                                                                                    "@items('For_each_Mx_ip')?['count']",
                                                                                    1
                                                                                ]
                                                                            },
                                                                            {
                                                                                "lessOrEquals": [
                                                                                    "@items('For_each_Mx_ip')?['count']",
                                                                                    "@variables('max_count')"
                                                                                ]
                                                                            }
                                                                        ]
                                                                    },
                                                                    "type": "If"
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Set_mx_ips_to_empty": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Foreach"
                                                        },
                                                        "MX_Compose": {
                                                            "runAfter": {
                                                                "Check_MX_Host_Count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Compose",
                                                            "inputs": {
                                                                "MX Domain": "@variables('mx_domain_value')",
                                                                "MX Host": "@variables('mx_host_value')",
                                                                "MX IP": "@substring(variables('mx_ips'),0,sub(length(variables('mx_ips')),1))",
                                                                "MX Priority": "@items('For_each_mx')?['priority']"
                                                            }
                                                        },
                                                        "Set_mx_ips_to_empty": {
                                                            "runAfter": {},
                                                            "type": "SetVariable",
                                                            "inputs": {
                                                                "name": "mx_ips",
                                                                "value": " "
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_ip": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_registrar_status": {
                                                    "foreach": "@items('Results_Loop')?['registrar_status']",
                                                    "actions": {
                                                        "Append_to_registrar_status_string_variable": {
                                                            "runAfter": {},
                                                            "type": "AppendToStringVariable",
                                                            "inputs": {
                                                                "name": "registrar_status",
                                                                "value": "@{items('For_each_registrar_status')},"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "Set_Tags_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "For_each_ssl_info": {
                                                    "foreach": "@items('Results_Loop')?['ssl_info']",
                                                    "actions": {
                                                        "Append_to_ssl_info_array_variable": {
                                                            "runAfter": {
                                                                "SSL_Info_Compose": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "AppendToArrayVariable",
                                                            "inputs": {
                                                                "name": "ssl_info",
                                                                "value": "@outputs('SSL_Info_Compose')"
                                                            }
                                                        },
                                                        "Check_Ssl_info_hash_count": {
                                                            "actions": {
                                                                "Set_ssl_info_hash_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ssl_info')?['hash']?['value'],variables('count_url_end_03')),items('For_each_ssl_info')?['hash']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                },
                                                                "Set_ssl_info_hash_value_with_link": {
                                                                    "runAfter": {
                                                                        "Set_ssl_info_hash_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ssl_info_hash_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "else": {
                                                                "actions": {
                                                                    "Set_ssl_info_hash_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ssl_info_hash_value",
                                                                            "value": "@{items('For_each_ssl_info')?['hash']?['value']}"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ssl_info')?['hash']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ssl_info')?['hash']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_ssl_info_org_count": {
                                                            "actions": {
                                                                "Set_ssl_org_with_count_link": {
                                                                    "runAfter": {
                                                                        "Set_ssl_org_with_link": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ssl_info_organization_value",
                                                                        "value": "@{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                },
                                                                "Set_ssl_org_with_link": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ssl_info')?['organization']?['value'],variables('count_url_end_03')),items('For_each_ssl_info')?['organization']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_ssl_info_subject_count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_ssl_org_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ssl_info_organization_value",
                                                                            "value": "@{items('For_each_ssl_info')?['organization']?['value']}"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ssl_info')?['organization']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ssl_info')?['organization']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "Check_ssl_info_subject_count": {
                                                            "actions": {
                                                                "Set_ssl_info_subject_link_3": {
                                                                    "runAfter": {},
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "count_url_link_03",
                                                                        "value": "@{concat(concat(concat(concat(items('For_each_ssl_info')?['subject']?['value'],variables('count_url_end_03')),items('For_each_ssl_info')?['subject']?['count']),variables('count_url_end_04')),variables('count_url_end_02'))}"
                                                                    }
                                                                },
                                                                "Set_ssl_info_subject_with_link": {
                                                                    "runAfter": {
                                                                        "Set_ssl_info_subject_link_3": [
                                                                            "Succeeded"
                                                                        ]
                                                                    },
                                                                    "type": "SetVariable",
                                                                    "inputs": {
                                                                        "name": "ssl_info_subject_value",
                                                                        "value": " @{concat(variables('count_url_link_02'),variables('count_url_link_03'))}"
                                                                    }
                                                                }
                                                            },
                                                            "runAfter": {
                                                                "Check_Ssl_info_hash_count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "else": {
                                                                "actions": {
                                                                    "Set_ssl_info_subject_without_link": {
                                                                        "runAfter": {},
                                                                        "type": "SetVariable",
                                                                        "inputs": {
                                                                            "name": "ssl_info_subject_value",
                                                                            "value": "@{items('For_each_ssl_info')?['subject']?['value']}"
                                                                        }
                                                                    }
                                                                }
                                                            },
                                                            "expression": {
                                                                "and": [
                                                                    {
                                                                        "greater": [
                                                                            "@items('For_each_ssl_info')?['subject']?['count']",
                                                                            1
                                                                        ]
                                                                    },
                                                                    {
                                                                        "lessOrEquals": [
                                                                            "@items('For_each_ssl_info')?['subject']?['count']",
                                                                            "@variables('max_count')"
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            "type": "If"
                                                        },
                                                        "SSL_Info_Compose": {
                                                            "runAfter": {
                                                                "Check_ssl_info_org_count": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "Compose",
                                                            "inputs": {
                                                                "SSL Info Hash": "@variables('ssl_info_hash_value')",
                                                                "SSL Info Organization": "@variables('ssl_info_organization_value')",
                                                                "SSL Info Subject": "@variables('ssl_info_subject_value')"
                                                            }
                                                        }
                                                    },
                                                    "runAfter": {
                                                        "For_each_Name_Server": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Foreach"
                                                },
                                                "IP_Table": {
                                                    "runAfter": {
                                                        "miscellaneouos_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('ips')"
                                                    }
                                                },
                                                "MX_Table": {
                                                    "runAfter": {
                                                        "IP_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('mxs')"
                                                    }
                                                },
                                                "Miscellaneous_Compose": {
                                                    "runAfter": {
                                                        "For_each_Tags": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Additional Whois Emails": "@substring(variables('additional_whois_emails'),0,sub(length(variables('additional_whois_emails')),1))",
                                                        "Email Domains": "@substring(variables('email_domains'),0,sub(length(variables('email_domains')),1))",
                                                        "SOA Emails": "@substring(variables('soa_emails'),0,sub(length(variables('soa_emails')),1))",
                                                        "SSL Emails": "@substring(variables('ssl_emails'),0,sub(length(variables('ssl_emails')),1))",
                                                        "Tags": "@substring(variables('tags'),0,sub(length(variables('tags')),1))"
                                                    }
                                                },
                                                "Nameserver_Table": {
                                                    "runAfter": {
                                                        "MX_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('nameservers')"
                                                    }
                                                },
                                                "Registrant_Contact_Compose": {
                                                    "runAfter": {
                                                        "Check_Registrant_Contact_Fax_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Registrant Contact City": "@variables('registrant_contact_city_value')",
                                                        "Registrant Contact Country": "@variables('registrant_contact_country_value')",
                                                        "Registrant Contact Email": "@substring(variables('registrant_contact_email'),0,sub(length(variables('registrant_contact_email')),1))",
                                                        "Registrant Contact Fax": "@variables('registrant_contact_fax_value')",
                                                        "Registrant Contact Name": "@variables('registrant_contact_name_value')",
                                                        "Registrant Contact Org": "@variables('registrant_contact_org_value')",
                                                        "Registrant Contact Phone": "@variables('registrant_contact_phone_value')",
                                                        "Registrant Contact Postal": "@variables('registrant_contact_postal_value')",
                                                        "Registrant Contact State": "@variables('registrant_contact_state_value')",
                                                        "Registrant Contact Street": "@variables('registrant_contact_street_value')"
                                                    }
                                                },
                                                "Registrant_Contact_Table": {
                                                    "runAfter": {
                                                        "Billing_Contact_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('registrant_contact_details')"
                                                    }
                                                },
                                                "SSL_Info_Table": {
                                                    "runAfter": {
                                                        "Nameserver_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('ssl_info')"
                                                    }
                                                },
                                                "Set_Admin_Contact_to_Empty": {
                                                    "runAfter": {},
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "admin_contact_details",
                                                        "value": []
                                                    }
                                                },
                                                "Set_Billing_Contact_Email_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Billing_Contact_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "billing_contact_email",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_Billing_Contact_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Set_Admin_Contact_Email_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "billing_contact_details",
                                                        "value": []
                                                    }
                                                },
                                                "Set_Domain_Details_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Techinical_Contact_Email_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "domain_details_array",
                                                        "value": []
                                                    }
                                                },
                                                "Set_Registrant_Contact_Email_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Registrant_Contact_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "registrant_contact_email",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_Registrant_Contact_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Billing_Contact_Email_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "registrant_contact_details",
                                                        "value": []
                                                    }
                                                },
                                                "Set_Set_Admin_Contact_Email_to_Empty": {
                                                    "runAfter": {
                                                        "Set_count_url_link_3_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "admin_contact_email",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_Tags_to_Empty": {
                                                    "runAfter": {
                                                        "Set_registrar_status_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "tags",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_Techinical_Contact_Email_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Techinical_Contact_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "technical_contact_email",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_Techinical_Contact_to_Empty": {
                                                    "runAfter": {
                                                        "Set_Registrant_Contact_Email_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "technical_contact_details",
                                                        "value": []
                                                    }
                                                },
                                                "Set_count_url_link_1": {
                                                    "runAfter": {
                                                        "For_each_registrar_status": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "count_url_link_01",
                                                        "value": "@{concat(variables('count_url_01'),variables('domain_name'))}"
                                                    }
                                                },
                                                "Set_count_url_link_1_to_empty": {
                                                    "runAfter": {
                                                        "Set_Admin_Contact_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "count_url_link_01",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_count_url_link_2": {
                                                    "runAfter": {
                                                        "Set_count_url_link_1": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "count_url_link_02",
                                                        "value": "@{concat(variables('count_url_link_01'),variables('count_url_end_01'))}"
                                                    }
                                                },
                                                "Set_count_url_link_3_to_empty": {
                                                    "runAfter": {
                                                        "Set_count_url_link_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "count_url_link_03",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_count_url_link_to_empty": {
                                                    "runAfter": {
                                                        "Set_count_url_link_1_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "count_url_link_02",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_ips_variable_to_empty": {
                                                    "runAfter": {
                                                        "Set_miscellaneous_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "ips",
                                                        "value": []
                                                    }
                                                },
                                                "Set_miscellaneous_to_empty": {
                                                    "runAfter": {
                                                        "Set_Domain_Details_to_Empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "Miscellaneous",
                                                        "value": []
                                                    }
                                                },
                                                "Set_mxs_variable_to_empty": {
                                                    "runAfter": {
                                                        "Set_ips_variable_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "mxs",
                                                        "value": []
                                                    }
                                                },
                                                "Set_nameservers_variable_to_empty": {
                                                    "runAfter": {
                                                        "Set_mxs_variable_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "nameservers",
                                                        "value": []
                                                    }
                                                },
                                                "Set_registrar_status_to_empty": {
                                                    "runAfter": {
                                                        "Set_ssl_info_variable_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "registrar_status",
                                                        "value": " "
                                                    }
                                                },
                                                "Set_ssl_info_variable_to_empty": {
                                                    "runAfter": {
                                                        "Set_nameservers_variable_to_empty": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "ssl_info",
                                                        "value": []
                                                    }
                                                },
                                                "Set_variable_2": {
                                                    "runAfter": {
                                                        "Check_registrant_org_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "registrar_value",
                                                        "value": "@{items('Results_Loop')?['registrar']}"
                                                    }
                                                },
                                                "Technical_Contact_Compose": {
                                                    "runAfter": {
                                                        "Check_technical_Contact_Fax_Count": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Technical Contact City": "@variables('technical_contact_city_value')",
                                                        "Technical Contact Country": "@variables('technical_contact_country_value')",
                                                        "Technical Contact Email": "@substring(variables('technical_contact_email'),0,sub(length(variables('technical_contact_email')),1))",
                                                        "Technical Contact Fax": "@variables('technical_contact_fax_value')",
                                                        "Technical Contact Name": "@variables('technical_contact_name_value')",
                                                        "Technical Contact Org": "@variables('technical_contact_org_value')",
                                                        "Technical Contact Phone": "@variables('technical_contact_phone_value')",
                                                        "Technical Contact Postal": "@variables('technical_contact_postal_value')",
                                                        "Technical Contact State": "@variables('technical_contact_state_value')",
                                                        "Technical Contact Street": "@variables('technical_contact_street_value')"
                                                    }
                                                },
                                                "Technical_Contact_Table": {
                                                    "runAfter": {
                                                        "Registrant_Contact_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('technical_contact_details')"
                                                    }
                                                },
                                                "_Domain_Details_Compose": {
                                                    "runAfter": {
                                                        "Condition": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Compose",
                                                    "inputs": {
                                                        "Active": "@items('Results_Loop')?['active']",
                                                        "Adsense": "@variables('adsense_value')",
                                                        "Alexa": "@items('Results_Loop')?['alexa']",
                                                        "Create Date": "@variables('create_date_value')",
                                                        "Data Updated Timestsamap": "@items('Results_Loop')?['data_updated_timestamp']",
                                                        "Domain": "@items('Results_Loop')?['domain']",
                                                        "Expiration Date": "@variables('expiration_date_value')",
                                                        "Google Analytics": "@items('Results_Loop')?['google_analytics']?['value']",
                                                        "Redirect": "@variables('redirect_value')",
                                                        "Redirect Domain": "@variables('redirect_domain_value')",
                                                        "Registrant Name": "@variables('registrant_name_value')",
                                                        "Registrant Org": "@variables('registrant_org_value')",
                                                        "Registrar": "@variables('registrar_value')",
                                                        "Registrar Status": "@substring(variables('registrar_status'),0,sub(length(variables('registrar_status')),1))",
                                                        "Risk Score": "@items('Results_Loop')?['domain_risk']?['risk_score']",
                                                        "SPF Info": "@items('Results_Loop')?['spf_info']",
                                                        "TLD": "@items('Results_Loop')?['tld']",
                                                        "Website Response": "@items('Results_Loop')?['website_response']",
                                                        "Whois URL": "@items('Results_Loop')?['whois_url']"
                                                    }
                                                },
                                                "miscellaneouos_Table": {
                                                    "runAfter": {
                                                        "Domain_Risk_Score_Components_Table": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "Table",
                                                    "inputs": {
                                                        "format": "HTML",
                                                        "from": "@variables('Miscellaneous')"
                                                    }
                                                },
                                                "set_additonal_whois_email_to_empty": {
                                                    "runAfter": {
                                                        "For_each_SSL_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "additional_whois_emails",
                                                        "value": " "
                                                    }
                                                },
                                                "set_email_domain_to_empty": {
                                                    "runAfter": {
                                                        "For_each_ssl_info": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "email_domains",
                                                        "value": " "
                                                    }
                                                },
                                                "set_soa_email_to_empty": {
                                                    "runAfter": {
                                                        "For_Each_Email_Domain": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "soa_emails",
                                                        "value": " "
                                                    }
                                                },
                                                "set_ssl_email_to_empty": {
                                                    "runAfter": {
                                                        "For_each_SOA_Email": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "SetVariable",
                                                    "inputs": {
                                                        "name": "ssl_emails",
                                                        "value": " "
                                                    }
                                                }
                                            },
                                            "runAfter": {},
                                            "type": "Foreach"
                                        }
                                    },
                                    "runAfter": {
                                        "Investigate_Domain": [
                                            "Succeeded"
                                        ]
                                    },
                                    "else": {
                                        "actions": {
                                            "Add_comment_to_incident_(V3)_2": {
                                                "runAfter": {},
                                                "type": "ApiConnection",
                                                "inputs": {
                                                    "body": {
                                                        "incidentArmId": "@triggerBody()?['object']?['id']",
                                                        "message": "<p><strong>No results found for:</strong> @{variables('domain_name')}</p>"
                                                    },
                                                    "host": {
                                                        "connection": {
                                                            "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                        }
                                                    },
                                                    "method": "post",
                                                    "path": "/Incidents/Comment"
                                                }
                                            }
                                        }
                                    },
                                    "expression": {
                                        "and": [
                                            {
                                                "greater": [
                                                    "@length(body('Investigate_Domain')?['response']?['results'])",
                                                    0
                                                ]
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "Investigate_Domain": {
                                    "runAfter": {
                                        "Check_DNS_Name_is_empty": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['domaintoolsirisinves']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/iris-investigate/investigate_domain",
                                        "queries": {
                                            "domain": "@variables('domain_name')"
                                        }
                                    }
                                },
                                "Set_DNS_Name_Variable": {
                                    "runAfter": {
                                        "Set_Host_Name_Variable": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "dns_name",
                                        "value": "@items('For_each_Host')?['DnsDomain']"
                                    }
                                },
                                "Set_Host_Name_Variable": {
                                    "runAfter": {},
                                    "type": "SetVariable",
                                    "inputs": {
                                        "name": "host_name",
                                        "value": "@items('For_each_Host')?['HostName']"
                                    }
                                }
                            },
                            "runAfter": {
                                "Entities_-_Get_Hosts": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach",
                            "runtimeConfiguration": {
                                "concurrency": {
                                    "repetitions": 1
                                }
                            }
                        },
                        "Host_Name_Variable": {
                            "runAfter": {
                                "MAX_COUNT_": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "host_name",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "MAX_COUNT_": {
                            "runAfter": {},
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "max_count",
                                        "type": "integer",
                                        "value": "@parameters('Pivot Threshold')"
                                    }
                                ]
                            }
                        },
                        "Miscellaneous_variable": {
                            "runAfter": {
                                "registrar_status_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "Miscellaneous",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "additional_whois_email": {
                            "runAfter": {
                                "ssl_emails": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "additional_whois_emails",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "additional_whois_email_value": {
                            "runAfter": {
                                "ssl_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "additional_whois_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_city_value": {
                            "runAfter": {
                                "admin_contact_street_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_city_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_country_value": {
                            "runAfter": {
                                "admin_contact_postal_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_country_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_details_variable": {
                            "runAfter": {
                                "domain_details_array_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_details",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "admin_contact_email_value": {
                            "runAfter": {
                                "admin_contact_fax_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_email_variable": {
                            "runAfter": {
                                "admin_contact_details_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_email",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_fax_value": {
                            "runAfter": {
                                "admin_contact_phone_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_fax_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_name_value": {
                            "runAfter": {
                                "google_analytics_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_name_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_org_value": {
                            "runAfter": {
                                "admin_contact_name_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_org_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_phone_value": {
                            "runAfter": {
                                "admin_contact_country_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_phone_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_postal_value": {
                            "runAfter": {
                                "admin_contact_state_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_postal_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_state_value": {
                            "runAfter": {
                                "admin_contact_city_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_state_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "admin_contact_street_value": {
                            "runAfter": {
                                "admin_contact_org_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "admin_contact_street_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "adsense_value": {
                            "runAfter": {
                                "nameservers_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "adsense_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_city_value": {
                            "runAfter": {
                                "billing_contact_street_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_city_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_country_value": {
                            "runAfter": {
                                "billing_contact_postal_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_country_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_details_variable": {
                            "runAfter": {
                                "admin_contact_email_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_details",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "billing_contact_email_value": {
                            "runAfter": {
                                "billing_contact_fax_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_email_variable": {
                            "runAfter": {
                                "billing_contact_details_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_email",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_fax_value": {
                            "runAfter": {
                                "billing_contact_phone_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_fax_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_name_value": {
                            "runAfter": {
                                "admin_contact_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_name_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_org_value": {
                            "runAfter": {
                                "billing_contact_name_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_org_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_phone_value": {
                            "runAfter": {
                                "billing_contact_country_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_phone_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_postal_value": {
                            "runAfter": {
                                "billing_contact_state_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_postal_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_state_value": {
                            "runAfter": {
                                "billing_contact_city_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_state_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "billing_contact_street_value": {
                            "runAfter": {
                                "billing_contact_org_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "billing_contact_street_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "count_url_01": {
                            "runAfter": {
                                "ssl_info_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_01",
                                        "type": "string",
                                        "value": "<a href=https://research.domaintools.com/iris/search/?q="
                                    }
                                ]
                            }
                        },
                        "count_url_end_01": {
                            "runAfter": {
                                "count_url_01": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_end_01",
                                        "type": "string",
                                        "value": ">"
                                    }
                                ]
                            }
                        },
                        "count_url_end_02": {
                            "runAfter": {
                                "count_url_end_01": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_end_02",
                                        "type": "string",
                                        "value": "</a>"
                                    }
                                ]
                            }
                        },
                        "count_url_end_03": {
                            "runAfter": {
                                "count_url_end_02": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_end_03",
                                        "type": "string",
                                        "value": "("
                                    }
                                ]
                            }
                        },
                        "count_url_end_04": {
                            "runAfter": {
                                "count_url_end_03": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_end_04",
                                        "type": "string",
                                        "value": ")"
                                    }
                                ]
                            }
                        },
                        "count_url_link_01": {
                            "runAfter": {
                                "count_url_end_04": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_link_01",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "count_url_link_02": {
                            "runAfter": {
                                "count_url_link_01": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_link_02",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "count_url_link_03": {
                            "runAfter": {
                                "count_url_link_02": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "count_url_link_03",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "create_date_value": {
                            "runAfter": {
                                "technical_contact_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "create_date_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "domain_details_array_variable": {
                            "runAfter": {
                                "Domain_Name_Variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "domain_details_array",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "email_domain_value": {
                            "runAfter": {
                                "expiration_date_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "email_domain_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "email_domains": {
                            "runAfter": {
                                "technical_contact_email_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "email_domains",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "expiration_date_value": {
                            "runAfter": {
                                "create_date_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "expiration_date_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "google_analytics_value": {
                            "runAfter": {
                                "adsense_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "google_analytics_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ip_address_value": {
                            "runAfter": {
                                "additional_whois_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ip_address_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ip_asn_value": {
                            "runAfter": {
                                "ip_address_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ip_asn_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ip_country_code_value": {
                            "runAfter": {
                                "ip_asn_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ip_country_code_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ip_isp_value": {
                            "runAfter": {
                                "ip_country_code_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ip_isp_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ips_asns_": {
                            "runAfter": {
                                "additional_whois_email": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ips_asns",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ips_variable": {
                            "runAfter": {
                                "Miscellaneous_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ips",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "mx_domain_value": {
                            "runAfter": {
                                "mx_host_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mx_domain_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "mx_host_value": {
                            "runAfter": {
                                "ip_isp_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mx_host_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "mx_ip_count": {
                            "runAfter": {
                                "mx_ip_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mx_ip_count",
                                        "type": "integer"
                                    }
                                ]
                            }
                        },
                        "mx_ip_value": {
                            "runAfter": {
                                "mx_domain_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mx_ip_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "mx_ips": {
                            "runAfter": {
                                "ips_asns_": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mx_ips",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "mxs_variable": {
                            "runAfter": {
                                "ips_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "mxs",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "name_server_domain_value": {
                            "runAfter": {
                                "name_server_host_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "name_server_domain_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "name_server_host_value": {
                            "runAfter": {
                                "mx_ip_count": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "name_server_host_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "name_server_ip_value": {
                            "runAfter": {
                                "name_server_domain_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "name_server_ip_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "name_server_ips": {
                            "runAfter": {
                                "mx_ips": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "name_server_ips",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "nameservers_variable": {
                            "runAfter": {
                                "mxs_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "nameservers",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "redirect_domain_value": {
                            "runAfter": {
                                "redirect_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "redirect_domain_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "redirect_value": {
                            "runAfter": {
                                "name_server_ip_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "redirect_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_city_value": {
                            "runAfter": {
                                "registrant_contact_street_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_city_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_country_value": {
                            "runAfter": {
                                "registrant_contact_postal_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_country_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_details_variable": {
                            "runAfter": {
                                "billing_contact_email_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_details",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_email_value": {
                            "runAfter": {
                                "registrant_contact_fax_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_email_variable": {
                            "runAfter": {
                                "registrant_contact_details_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_email",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_fax_value": {
                            "runAfter": {
                                "registrant_contact_phone_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_fax_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_name_value": {
                            "runAfter": {
                                "billing_contact_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_name_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_org_value": {
                            "runAfter": {
                                "registrant_contact_name_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_org_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_phone_value": {
                            "runAfter": {
                                "registrant_contact_country_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_phone_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_postal_value": {
                            "runAfter": {
                                "registrant_contact_state_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_postal_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_state_value": {
                            "runAfter": {
                                "registrant_contact_city_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_state_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_contact_street_value": {
                            "runAfter": {
                                "registrant_contact_org_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_contact_street_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_name_value": {
                            "runAfter": {
                                "redirect_domain_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_name_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrant_org_value": {
                            "runAfter": {
                                "registrant_name_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrant_org_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrar_status_variable": {
                            "runAfter": {
                                "tags_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrar_status",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "registrar_value": {
                            "runAfter": {
                                "registrant_org_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "registrar_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "soa_email_value": {
                            "runAfter": {
                                "email_domain_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "soa_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "soa_emails": {
                            "runAfter": {
                                "email_domains": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "soa_emails",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_email_value": {
                            "runAfter": {
                                "soa_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_emails": {
                            "runAfter": {
                                "soa_emails": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_emails",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_info_array": {
                            "runAfter": {
                                "name_server_ips": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_info",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "ssl_info_email_value": {
                            "runAfter": {
                                "ssl_info_organization_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_info_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_info_hash_value": {
                            "runAfter": {
                                "registrar_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_info_hash_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_info_organization_value": {
                            "runAfter": {
                                "ssl_info_subject_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_info_organization_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "ssl_info_subject_value": {
                            "runAfter": {
                                "ssl_info_hash_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "ssl_info_subject_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "tags_variable": {
                            "runAfter": {
                                "ssl_info_array": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "tags",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_city_value": {
                            "runAfter": {
                                "technical_contact_street_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_city_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_country_value": {
                            "runAfter": {
                                "technical_contact_postal_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_country_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_details_variable": {
                            "runAfter": {
                                "registrant_contact_email_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_details",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "technical_contact_email_value": {
                            "runAfter": {
                                "technical_contact_fax_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_email_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_email_variable": {
                            "runAfter": {
                                "technical_contact_details_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_email",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_fax_value": {
                            "runAfter": {
                                "technical_contact_phone_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_fax_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_name_value": {
                            "runAfter": {
                                "registrant_contact_email_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_name_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_org_value": {
                            "runAfter": {
                                "technical_contact_name_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_org_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_phone_value": {
                            "runAfter": {
                                "technical_contact_country_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_phone_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_postal_value": {
                            "runAfter": {
                                "technical_contact_state_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_postal_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_state_value": {
                            "runAfter": {
                                "technical_contact_city_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_state_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "technical_contact_street_value": {
                            "runAfter": {
                                "technical_contact_org_value": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "technical_contact_street_value",
                                        "type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azuresentinel": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('AzureSentinelConnectionName'))]",
                                "connectionName": "[variables('AzureSentinelConnectionName')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/azuresentinel')]",
								"connectionProperties": {
									"authentication": {
										"type": "ManagedServiceIdentity"
									}
								}
                            },
                            "domaintoolsirisinves": {
                                "connectionId": "[resourceId('Microsoft.Web/connections', variables('DomainToolsApiKey'))]",
                                "connectionName": "[variables('DomainToolsApiKey')]",
                                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/domaintoolsirisinves')]"
                            }
                        }
                    }
                }
            }
        }
    ]
}
